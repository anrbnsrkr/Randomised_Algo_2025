The python code looks very messy right now. Sorry for that, will properly format it and add comments soon.
